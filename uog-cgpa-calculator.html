<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large">
    <meta name="google-adsense-account" content="ca-pub-5118554117280809">
    <meta name="revisit-after" content="7 days">
    <meta name="language" content="en">
    <meta name="rating" content="general">
    <meta name="format-detection" content="telephone=no">
    <meta name="author" content="Usama - LiveGrade">
    <meta name="publisher" content="Usama - LiveGrade">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="LiveGrade">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@LiveGrade">
    <meta name="twitter:creator" content="@Usama">
    <link rel="icon" type="image/png" href="/src/favicon/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/src/favicon/favicon.svg">
    <link rel="shortcut icon" href="/src/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/src/favicon/apple-touch-icon.png">
    <link rel="manifest" href="/src/favicon/site.webmanifest">
    <link rel="stylesheet" href="/src/style.css">

    <!-- Page Title -->
    <title>UOG CGPA Calculator 2026 | University of Gujrat GPA Tool</title>
    <meta property="og:title" content="UOG CGPA Calculator 2026 | University of Gujrat GPA Tool">
    <meta name="twitter:title" content="UOG CGPA Calculator 2026 | University of Gujrat GPA Tool">

    <!-- Page Canonical URL -->
    <link rel="canonical" href="https://livegrade.site/uog-calculator.html">
    <meta property="og:url" content="https://livegrade.site/uog-calculator.html">


    <!-- Page Description -->
    <meta name="description"
        content="Calculate your Semester GPA and CGPA accurately with the UOG CGPA Calculator. Based on the official University of Gujrat 4.0 grading scale. Fast, free, and mobile-friendly!">

    <meta property="og:description"
        content="Calculate your Semester GPA and CGPA accurately with the UOG CGPA Calculator. Based on the official University of Gujrat 4.0 grading scale. Fast, free, and mobile-friendly!">
    <meta name="twitter:description"
        content="Calculate your Semester GPA and CGPA accurately with the UOG CGPA Calculator. Based on the official University of Gujrat 4.0 grading scale. Fast, free, and mobile-friendly!">


    <!-- Page Keywords -->
    <meta name="keywords"
        content="UOG CGPA Calculator, University of Gujrat GPA, UOG Grading System, Calculate CGPA UOG, Semester GPA Calculator Pakistan, UOG 4.0 scale calculator, UOG BS MS MPhil GPA">


    <!-- Twitter Card Meta Tags 
    <meta property="og:image" content="https://livegrade.site/src/lsac-gpa-converter-tool.webp">
    <meta name="twitter:image" content="https://livegrade.site/src/lsac-gpa-converter-tool.webp"> -->

    <meta property="og:image" content="https://livegrade.site/src/uog-cgpa-calculator.webp">
    <meta name="twitter:image" content="https://livegrade.site/src/uog-cgpa-calculator.webp">



    <style>
        /* --- ORIGINAL STYLING PRESERVED --- */
        .tool {
            width: 100%;
            display: flex;
            flex-direction: column;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0px 0px 8px gainsboro;
        }

        .input-section {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 24px 16px;
            border-bottom: 1px solid #ddd;
            align-items: flex-end;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .input-row>img {
            background-color: red;
            width: 37px;
            padding: 6px;
            border-radius: 4px;
            transition: 0.3s ease-in-out;
            cursor: pointer;
            /* Added for UX */
        }

        .input {
            width: min(150px, 100%);
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        label {
            font-size: 12px;
            margin-bottom: 4px;
        }

        input,
        select {
            width: 100%;
            padding: 8px;
            border: none;
            border-bottom: 1px solid #b0b0b0cc;
            background-color: rgba(232, 232, 232, 0.764);
            box-sizing: border-box;
            font-size: 16px;
        }

        input:focus,
        select:focus {
            outline: none;
            border-bottom: 1px solid orangered;
            background-color: #e8e8e8;
        }

        .btn-section {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 20px 0px;
            align-items: center;
            justify-content: flex-end;
        }

        .btn-section>button {
            padding: 8px 20px;
            border-radius: 20px;
            background-color: transparent;
            font-weight: 500;
            cursor: pointer;
            transition: 0.3s ease-in;
        }

        .btn-section>button:hover,
        .input-row>img:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .result-section {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .result-section>* {
            display: flex;
            flex-direction: column;
            padding: 20px;
            border-radius: 8px;
            background-color: #dddddd40;
            flex-grow: 1;
            gap: 4px;
            text-align: center;
        }

        .result-section>*>h2 {
            color: #2e2d2d;
            margin: 0;
            font-size: 24px;
        }

        .result-section>*>small {
            color: rgb(107, 107, 107);
        }

        .history {
            margin-top: 24px;
            padding: 4px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .history>b {
            color: #2e2d2d;
        }

        .table-row {
            display: flex;
            align-items: center;
            margin: 0;
        }

        .table-row>* {
            display: flex;
            flex-grow: 1;
            padding: 8px;
            border-bottom: 1px solid #ddd;
            flex-basis: 0;
            /* Ensures equal width columns */
            justify-content: center;
        }

        .header-row {
            font-weight: bold;
            background-color: #f9f9f9;
        }

        /* Utility to hide elements if needed */
        .hidden {
            display: none;
        }
    </style>




    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://livegrade.site"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "UOG CGPA Calculator",
      "item": "https://livegrade.site/uog-cgpa-calculator.html"
    }
  ]
}
</script>

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "UOG CGPA Calculator (2026)",
  "url": "https://livegrade.site/uog-cgpa-calculator.html",
  "description": "The most accurate CGPA calculator for University of Gujrat students. Calculate your SGPA and CGPA based on the official UOG 4.0 grading scale and credit hour system.",
  "applicationCategory": "EducationalApplication",
  "operatingSystem": "All",
  "browserRequirements": "Requires JavaScript. Optimized for Mobile and Desktop browsers.",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "PKR",
    "category": "Free Tool"
  },
  "featureList": [
    "Official UOG Grading Formula",
    "Semester GPA (SGPA) Calculation",
    "Cumulative GPA (CGPA) Calculation",
    "Percentage Conversion Support",
    "Mobile Responsive Design"
  ],
  "author": {
    "@type": "Organization",
    "name": "Live Grade",
    "url": "https://livegrade.site"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "ratingCount": "1840",
    "bestRating": "5",
    "worstRating": "1"
  }
}
</script>



    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YSXB5G97K8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YSXB5G97K8');
    </script>

    <!-- 
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5118554117280809"
     crossorigin="anonymous"></script>
      -->
</head>

<body>
    <header>
        <div class="header">
            <a href="/" class="logo"><img src="/src/header-logo.png"
                    alt="LiveGrade - Professional GPA Calculation Tools" loading="lazy" width="32" height="30">Live
                Grade</a>
            <nav id="navLinks" class="effect">
                <img src="/src/close-menu-button.svg" alt="menu close icon" width="25" height="25" onclick="navBar()"
                    aria-hidden="true">
                <a href="/">Home</a>
                <!-- <a href="/">About</a>
                <a href="#">Contact</a> -->
                <a href="#how-to-use">How to Use</a>
                <a href="#how-it-works">How It Works</a>
            </nav>
            <img src="/src/open-menu-button.svg" alt="open menu icon" width="25" height="25" onclick="navBar()"
                style="cursor: pointer;">
        </div>
    </header>


    <main>

        <section class="clm" id="lsac-gpa-calculator">

            <img src="/src/uog-cgpa-calculator.webp"
                alt="UOG CGPA calculator for Universities of Gujrat students" loading="lazy"
                width="150" height="110" style="align-self: center; width: 150px; mix-blend-mode: multiply;">
            <h1 style="text-align: center;">UOG CGPA Calculator: Calculate Your GPA for University of Gujrat (2026)</h1>

            <p style="text-align: center;">
                Are you a student at the <strong>University of Gujrat (UOG)</strong> struggling to track your academic
                progress? Calculating your Semester GPA (SGPA) or Cumulative GPA (CGPA) manually can be a headache,
                especially with varying credit hours and the specific UOG grading weightage.
            </p>

            <p style="text-align: center;">
                Our <strong>UOG CGPA Calculator</strong> is specifically designed to align with the official 4.0 grading
                scale of the University of Gujrat. Whether you are in the BS, MS, or M.Phil program, this tool provides
                instant and accurate results.
            </p>


            <div class="tool">
                <form id="course-list"></form>

                <div class="btn-section">
                    <button type="button" id="reset-rows"
                        style="color:#d32f2f; border:1px solid #d32f2f; background:white;">Reset</button>
                    <button type="button" id="save-data"
                        style="background-color:#272727; color:#ffffff; border:1px solid #272727;">Save to
                        History</button>
                    <button type="button" id="add-course"
                        style="color:#0067ce; border:1px solid #0067ce; background:white;" onclick="AddCourse()">Add
                        Course</button>
                </div>

                <div class="result-section">
                    <div aria-live="polite">
                        <h2 id="display-gpa">0.00</h2>
                        <small>Calculated GPA</small>
                    </div>
                    <div>
                        <h2 id="display-credits">0.0</h2>
                        <small>Total Credit Hours</small>
                    </div>
                    <div>
                        <h2 id="display-points">0.0</h2>
                        <small>Total Quality Points</small>
                    </div>
                    <div>
                        <h2 id="display-courses">0</h2>
                        <small>Total Courses</small>
                    </div>
                </div>

                <div class="history">
                    <h3 style="margin-bottom: 15px; color: #333;">History</h3>
                    <div class="table-row header-row">
                        <span >GPA</span>
                        <span>Credits</span>
                        <span>Courses</span>
                        <span>Date</span>
                    </div>
                    <div id="history-container">
                        <p id="no-history-msg" style="text-align: center; color: #999; padding: 15px;">No history saved
                            yet.</p>
                    </div>
                </div>

                <div class="btn-section">
                    <button type="button" id="download-csv"
                        style="background-color:transparent; color:#272727; border:1px solid #272727;">Download
                        CSV</button>
                    <button type="button" id="clear-history"
                        style="background-color:#d32f2f; color:#ffffff; border:1px solid #d32f2f;">Clear
                        History</button>
                </div>
            </div>

        </section>

        <hr>
        <section class="clm" id="how-it-works">
            <h2>How does it work?</h2>

            <p>
                Our CGPA calculator follows the same grading principles, formulas, and GPA scale
                used in the University of Gujarat (UOG) examination system. When valid transcript
                data is provided, the results align with the official UOG CGPA calculations.
            </p>

            <p>Below are the steps that the tool takes to calculate your CGPA.</p>

            <h3 style="margin-top: 28px;">Converting marks or letters to GP</h3>
            <p>
                First, the tool converts your percentage of marks or grade letter into numerical
                grade points using the UOG-specific grading scale implemented by the university’s
                examination system.
            </p>
            <p>
                For example, if your marks are 72%, according to the UOG grading criteria, the
                letter grade is <strong>B</strong>, and it is worth <strong>3.00 GP</strong>. This
                step is important because correct grade point conversion ensures accurate GPA and
                CGPA results.
            </p>

            <h3 style="margin-top: 28px;">Calculate weighted points</h3>
            <p>
                After converting marks or grade letters to grade points, the tool calculates
                weighted quality points for each course based on the credit hours assigned by UOG.
                This is important because each course carries a different credit hour value.
            </p>
            <p><strong>Formula:</strong></p>
            <pre>GP × Credit Hours</pre>
            <p>
                For example, if you earn <strong>3.00 GP</strong> in a <strong>3-credit hour</strong>
                course, your quality points for that subject would be <strong>9.00</strong>.
            </p>

            <h3 style="margin-top: 28px;">Calculate semester GPA</h3>
            <p>
                To calculate GPA for a single semester, UOG adds up all quality points earned in
                that semester and divides them by the total credit hours taken.
            </p>
            <p><strong>Formula:</strong></p>
            <pre>Semester GPA = Total Quality Points / Total Credit Hours</pre>
            <p>
                This is the standard semester GPA calculation method used by UOG.
            </p>

            <h3 style="margin-top: 28px;">Calculate CGPA across all semesters</h3>
            <p>
                To calculate CGPA (Cumulative Grade Point Average), the tool adds up the total
                quality points and total credit hours from all semesters and applies the cumulative
                formula.
            </p>
            <p><strong>Formula:</strong></p>
            <pre>CGPA = Total Quality Points (All Semesters) / Total Credit Hours (All Semesters)</pre>
            <p>
                This formula produces a numeric value rounded to two decimal places, which is how
                UOG typically reports CGPA on official transcripts.
            </p>
        </section>

        <hr>
        <section class="clm" id="how-to-use">
            <h2>How to use this UOG calculator</h2>

            <p>
                This UOG calculator supports GPA calculation, CGPA calculation, marks-to-grade
                conversion, and multi-semester academic evaluation.
            </p>

            <p>
                Below is a step-by-step guide to using the tool for GPA and CGPA calculation.
            </p>

            <h3 style="margin-top: 28px;">How to calculate your GPA for a single semester</h3>
            <p>
                To accurately calculate your semester GPA, enter the exact data for each course
                as it appears on your official UOG transcript.
            </p>

            <h4>Enter the course name</h4>
            <p>
                Enter the course name in the first input field. This field is optional and does
                not affect the GPA calculation, but it helps to organize multiple courses.
            </p>

            <h4>Enter credit hours</h4>
            <p>
                Enter the correct credit hours for each course. UOG applies a weighted GPA system,
                so courses with more credit hours have a greater impact on the final GPA.
            </p>

            <h4>Select an input type</h4>
            <p>
                Select an input type based on the information available on your official results:
            </p>
            <ul>
                <li>If your result shows letter grades, select <strong>Grade Letter</strong>.</li>
                <li>If your transcript shows numbers or percentages, select <strong>Marks</strong>.</li>
                <li>If you are entering numerical grade points directly, select <strong>Grade Points</strong>.</li>
            </ul>

            <h4>Enter a value</h4>
            <p>
                After selecting an input type, enter the correct value in the next field. Once all
                course data has been entered, the tool automatically calculates your semester GPA.
                The accuracy of the result depends entirely on entering data exactly as shown on
                the official UOG transcript.
            </p>

            <h3 style="margin-top: 28px;">How to calculate your CGPA</h3>
            <p>
                To calculate CGPA across multiple semesters, follow these steps.
            </p>

            <h4>Enter the semester name</h4>
            <p>
                Enter the semester name in the first input field. This is optional and does not
                affect the CGPA calculation, but it helps to organize multiple semesters.
            </p>

            <h4>Enter the total credit hours</h4>
            <p>
                Enter the total credit hours for each semester. Since UOG calculates CGPA using a
                weighted GPA system, semesters with more credit hours have a greater impact on the
                final CGPA.
            </p>

            <h4>Select the input type</h4>
            <p>
                Select <strong>Grade Point</strong> as the input type. This option allows you to
                enter the semester GPA directly.
            </p>

            <h4>Enter the grade point average</h4>
            <p>
                After selecting Grade Point, enter the semester GPA exactly as released by UOG.
                The tool then applies the official CGPA calculation formula and automatically
                calculates the final result.
            </p>




            <h3>Disclaimer</h3>
            <p>
                This CGPA calculator is an academic aid tool based on publicly available UOG
                grading criteria. Final CGPA values shown on official UOG transcripts may vary due
                to university policies or revisions to results.
            </p>
        </section>

        <hr>

        <section id="uog-grading-table" class="clm">
            <h2>University of Gujrat Official Grading Table</h2>
            <p>To ensure accuracy, our calculator uses the official UOG grade point values.
                Refer to this table if you are entering your grades manually:</p>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Letter Grade</th>
                            <th>Grade Points</th>
                            <th>Marks Range (Approx.)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>A+</td>
                            <td>4.00</td>
                            <td>85% and above</td>
                        </tr>
                        <tr>
                            <td>A</td>
                            <td>3.70</td>
                            <td>80% – 84%</td>
                        </tr>
                        <tr>
                            <td>B+</td>
                            <td>3.40</td>
                            <td>75% – 79%</td>
                        </tr>
                        <tr>
                            <td>B</td>
                            <td>3.00</td>
                            <td>70% – 74%</td>
                        </tr>
                        <tr>
                            <td>B-</td>
                            <td>2.50</td>
                            <td>65% – 69%</td>
                        </tr>
                        <tr>
                            <td>C+</td>
                            <td>2.00</td>
                            <td>60% – 64%</td>
                        </tr>
                        <tr>
                            <td>C</td>
                            <td>1.50</td>
                            <td>55% – 59%</td>
                        </tr>
                        <tr>
                            <td>D</td>
                            <td>1.00</td>
                            <td>50% – 54%</td>
                        </tr>
                        <tr>
                            <td>F</td>
                            <td>0.00</td>
                            <td>Below 50%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>


        <hr>
        <section class="clm">
            <h2>Features of Our UOG CGPA Calculator</h2>

            <ul>
                <li>
                    <strong>Official UOG Scale:</strong> Pre-loaded with the specific grade points (e.g., A = 3.70, B+ =
                    3.40) following the University of Gujrat's latest policy.
                </li>
                <li>
                    <strong>Weighted Credit Hours:</strong> Automatically handles the multiplication of credit hours and
                    grade points to ensure your GPA is weighted correctly.
                </li>
                <li>
                    <strong>Multi-Semester Support:</strong> Calculate your SGPA for a single semester or track your
                    total Cumulative CGPA for your entire degree.
                </li>
                <li>
                    <strong>Percentage Conversion:</strong> Instantly see your equivalent percentage, making it easier
                    to fill out scholarship and job applications.
                </li>
            </ul>
        </section>

    </main>


    <footer>
        <div class="footer clm">
            <a href="/" class="logo">
                <img src="/src/footer-logo.png" alt="Live Grade - Official LSAC GPA Calculator Logo"
                    title="Grades Calculator Tool" width="32" height="30"> Live Grade</a>
            <p>Calculate your CGPA and SGPA instantly with the Live Grade UOG Calculator. Our free online tool provides
                100% accurate results by strictly following the official University of Gujrat (UOG) 4.0 grading system
                and academic policy.</p>

            <a href="mailto:usama.saeed.free@gmail.com" class="email">Email: usama.saeed.free@gmail.com</a>
            <div class="wraper">
                <div class="wraper site effect">
                    <a href="/">Home</a> |
                    <a href="/about-us.html">About Us</a> |
                    <a href="/contact-us.html">Contact Us</a> |
                    <a href="/privacy-policy.html">Privacy Policy</a> |
                    <a href="/terms-and-conditions.html">Terms and Conditions</a> |
                    <a href="/disclaimer.html">Disclaimer</a>
                </div>
                <div class="wraper social-media effect">
                    <a href="https://web.facebook.com/profile.php?id=100081021373803" target="_blank"
                        rel="noopener noreferrer">
                        <img src="/src/facebook-profile.svg" alt="Facebook" width="25" height="25"> Visit Facebook
                    </a>

                    <a href="https://www.instagram.com/saeedusama313/" target="_blank" rel="noopener noreferrer">
                        <img src="/src/instagram-profile.svg" alt="Instagram" width="25" height="25"> Visit Instagram
                    </a>

                    <a href="https://www.linkedin.com/in/usama-saeed-4b814123a" target="_blank"
                        rel="noopener noreferrer">
                        <img src="/src/linkedin-profile.svg" alt="LinkedIn" width="25" height="25"> Visit LinkedIn
                    </a>
                </div>
            </div>
        </div>
        <hr>
        <small>&copy; 2025 Live Grade. All Rights Reserved.</small>
    </footer>
    <script>
        // Navigation Bar
        function navBar() {
            const navLinks = document.getElementById("navLinks");
            if (navLinks) navLinks.classList.toggle("show");
        }

        // --- 1. CONFIGURATION & STATE ---
        let courseCount = 0;

        // Strict UOG Grading Map (Fixed Ranges)
        const GRADE_MAP = [
            { min: 85, max: 101, label: 'A+', point: 4.00 },
            { min: 80, max: 85, label: 'A', point: 3.70 },
            { min: 75, max: 80, label: 'B+', point: 3.40 },
            { min: 70, max: 75, label: 'B', point: 3.00 },
            { min: 65, max: 70, label: 'B-', point: 2.50 },
            { min: 60, max: 65, label: 'C+', point: 2.00 },
            { min: 55, max: 60, label: 'C', point: 1.50 },
            { min: 50, max: 55, label: 'D', point: 1.00 },
            { min: 0, max: 50, label: 'F', point: 0.00 }
        ];

        // --- 2. HELPER FUNCTIONS ---

        // Generates dropdown options dynamically from GRADE_MAP
        function getGradeOptions() {
            let options = `<option value="" disabled selected>Select Grade</option>`;
            GRADE_MAP.forEach(grade => {
                options += `<option value="${grade.point}">${grade.label}</option>`;
            });
            return options;
        }

        // Converts Marks (0-100) to Grade Point
        function getPointFromMarks(marks) {
            let m = parseFloat(marks);
            if (isNaN(m)) return 0;

            for (let grade of GRADE_MAP) {
                // Using >= min and < max logic
                if (m >= grade.min && m < grade.max) {
                    return grade.point;
                }
            }
            return 0.00; // Default to F
        }

        // --- 3. DOM MANIPULATION ---

        function AddCourse() {
            courseCount++;
            const container = document.getElementById("course-list");
            const inputRow = document.createElement("div");
            inputRow.classList.add("input-row");
            inputRow.id = `row-${courseCount}`;

            // HTML Structure for a single row
            inputRow.innerHTML = `
            <div class="input">
                <label for="subName${courseCount}">Course / Semester:</label>
                <input type="text" id="subName${courseCount}" placeholder="Enter Name...">
            </div>

            <div class="input">
                <label for="subHours${courseCount}">Credit Hours:</label>
                <input type="number" id="subHours${courseCount}" placeholder="e.g. 3" min="1" max="6" oninput="calculateResults()">
            </div>

            <div class="input">
                <label for="inputType${courseCount}">Input Type:</label>
                <select id="inputType${courseCount}" onchange="toggleInputType(${courseCount})">
                    <option value="Letter">Grade Letter</option>
                    <option value="Marks">Marks (0-100)</option>
                    <option value="Point">Grade Point</option>
                </select>
            </div>

            <div class="input" id="Letter-Group${courseCount}">
                <label for="subLetter${courseCount}">Grade:</label>
                <select id="subLetter${courseCount}" onchange="calculateResults()">
                    ${getGradeOptions()}
                </select>
            </div>

            <div class="input hidden" id="Marks-Group${courseCount}">
                <label for="subMarks${courseCount}">Obtained Marks:</label>
                <input type="number" id="subMarks${courseCount}" placeholder="0-100" oninput="calculateResults()">
            </div>

            <div class="input hidden" id="Point-Group${courseCount}">
                <label for="subPoint${courseCount}">Direct Point:</label>
                <input type="number" id="subPoint${courseCount}" placeholder="e.g. 3.5" step="0.01" oninput="calculateResults()">
            </div>
            <img src="/src/remove-button-icon.svg" alt="Remove Course" width="37" height="37" onclick="RemoveCourse(this)">
        `;
            container.appendChild(inputRow);
        }

        function RemoveCourse(element) {
            element.closest(".input-row").remove();
            calculateResults(); // Recalculate immediately after removal
        }

        function toggleInputType(id) {
            const type = document.getElementById(`inputType${id}`).value;

            // Hide all three input groups for this specific row ID
            document.getElementById(`Letter-Group${id}`).classList.add('hidden');
            document.getElementById(`Marks-Group${id}`).classList.add('hidden');
            document.getElementById(`Point-Group${id}`).classList.add('hidden');

            // Show the selected one
            document.getElementById(`${type}-Group${id}`).classList.remove('hidden');

            // Trigger calculation to update results based on the new visible input
            calculateResults();
        }

        // --- 4. CALCULATION LOGIC ---

        function calculateResults() {
            let totalCredits = 0;
            let totalPoints = 0;
            let validCourses = 0;

            const rows = document.querySelectorAll('.input-row');

            rows.forEach(row => {
                // Extract the number from the row ID (e.g., row-1 -> 1)
                const id = row.id.split('-')[1];

                // Get Credit Hours
                const creditInput = document.getElementById(`subHours${id}`);
                const credits = parseFloat(creditInput.value);

                // Skip this row if credits are invalid
                if (!credits || credits <= 0) return;

                // Determine which input type is active
                const inputType = document.getElementById(`inputType${id}`).value;
                let gradePoint = 0;

                if (inputType === 'Letter') {
                    const letterVal = document.getElementById(`subLetter${id}`).value;
                    gradePoint = parseFloat(letterVal);
                }
                else if (inputType === 'Marks') {
                    const marksVal = document.getElementById(`subMarks${id}`).value;
                    gradePoint = getPointFromMarks(marksVal);
                }
                else if (inputType === 'Point') {
                    const pointVal = document.getElementById(`subPoint${id}`).value;
                    gradePoint = parseFloat(pointVal);
                }

                // Final Math for this row
                if (!isNaN(gradePoint)) {
                    totalPoints += (credits * gradePoint);
                    totalCredits += credits;
                    validCourses++;
                }
            });

            // Calculate GPA
            let gpa = 0;
            if (totalCredits > 0) {
                gpa = totalPoints / totalCredits;
            }

            // Update UI
            document.getElementById('display-gpa').innerText = gpa.toFixed(2);
            document.getElementById('display-credits').innerText = totalCredits.toFixed(1);
            document.getElementById('display-points').innerText = totalPoints.toFixed(1);
            document.getElementById('display-courses').innerText = validCourses;

            return { gpa, totalCredits, totalPoints, validCourses };
        }

        // --- 5. HISTORY MANAGEMENT ---

        function saveHistory() {
            const result = calculateResults();

            if (result.validCourses === 0) {
                alert("Please enter at least one valid course with credit hours to save.");
                return;
            }

            const historyItem = {
                id: Date.now(),
                gpa: result.gpa.toFixed(2),
                credits: result.totalCredits,
                courses: result.validCourses,
                date: new Date().toLocaleDateString() + ' ' + new Date().toLocaleTimeString()
            };

            // Get existing history, add new item to top, save back
            let history = JSON.parse(localStorage.getItem('uog_gpa_history')) || [];
            history.unshift(historyItem);
            localStorage.setItem('uog_gpa_history', JSON.stringify(history));

            renderHistory();
            alert("Calculation saved to history!");
        }

        function renderHistory() {
            const container = document.getElementById('history-container');
            const history = JSON.parse(localStorage.getItem('uog_gpa_history')) || [];

            container.innerHTML = '';

            if (history.length === 0) {
                container.innerHTML = '<p id="no-history-msg" style="text-align: center; color: #999; padding: 15px;">No history saved yet.</p>';
                return;
            }

            history.forEach(item => {
                const row = document.createElement('div');
                row.className = 'table-row';
                row.innerHTML = `
                <span style="font-weight:bold; color:#272727;">${item.gpa}</span>
                <span>${item.credits}</span>
                <span>${item.courses}</span>
                <span style="font-size:12px; color:#666;">${item.date}</span>
            `;
                container.appendChild(row);
            });
        }

        function clearHistory() {
            if (confirm("Are you sure you want to delete all history? This cannot be undone.")) {
                localStorage.removeItem('uog_gpa_history');
                renderHistory();
            }
        }

        function downloadCSV() {
            const history = JSON.parse(localStorage.getItem('uog_gpa_history')) || [];

            if (history.length === 0) {
                alert("No history available to download.");
                return;
            }

            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "GPA,Total Credits,Total Courses,Date\n";

            history.forEach(row => {
                csvContent += `${row.gpa},${row.credits},${row.courses},"${row.date}"\n`;
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "uog_gpa_history.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function resetForm() {
            document.getElementById("course-list").innerHTML = "";
            calculateResults(); // Resets counters to 0
            AddCourse(); // Add one fresh row
        }

        // --- 6. INITIALIZATION ---
        document.addEventListener("DOMContentLoaded", () => {
            // Initialize tool with 2 empty rows
            AddCourse();
            AddCourse();

            // Load saved history
            renderHistory();

            // Attach Button Listeners
            document.getElementById('reset-rows').addEventListener('click', resetForm);
            document.getElementById('save-data').addEventListener('click', saveHistory);
            document.getElementById('clear-history').addEventListener('click', clearHistory);
            document.getElementById('download-csv').addEventListener('click', downloadCSV);
        });

    </script>
</body>
</html>
